from datetime import date,datetime
from scheduler.models import TLE, NextPass
from scheduler.searchAlgorithms import _Helper
from django.test import TestCase


class FitnessFunctionTests(TestCase):

	def test_findSchedulableSatellites_many_real_sats(self):

		catAOS = datetime(2017,1,25,0,52,59)
		catLOS = datetime(2017,1,25,1,4,28)
		sixtysevenCAOS = datetime(2017,1,25,0,6,52)
		sixtysevenCLOS = datetime(2017,1,25,0,14,42)
		sixtysevenDAOS = datetime(2017,1,25,0,8,37)
		sixtysevenDLOS = datetime(2017,1,25,0,16,18)
		aistAOS = datetime(2017,1,25,0,35,21)
		aistLOS = datetime(2017,1,25,0,48,8)
		beesatAOS = datetime(2017,1,25,0,46,48)
		beesatLOS = datetime(2017,1,25,1,0,4) 
		briteAOS = datetime(2017,1,25,0,19,39)
		briteLOS = datetime(2017,1,25,0,30,4)
		cubebugAOS = datetime(2017,1,25,0,41,54)
		cubebugLOS = datetime(2017,1,25,0,52,49)
		sailAOS = datetime(2017,1,25,0,41,17)
		sailLOS = datetime(2017,1,25,0,53,28)
		eagleAOS = datetime(2017,1,25,0,53,13)
		eagleLOS = datetime(2017,1,25,1,2,56)	
		exoAOS = datetime(2017,1,25,0,57,27)
		exoLOS = datetime(2017,1,25,1,5,27)
		fconeAOS = datetime(2017,1,25,0,17,14)
		fconeLOS = datetime(2017,1,25,0,30,6)
		fcthreeAOS = datetime(2017,1,25,0,11,3)
		fcthreeLOS = datetime(2017,1,25,0,23,54)
		fcfiveAOS = datetime(2017,1,25,0,8,47)
		fcfiveLOS = datetime(2017,1,25,0,21,37)
		fceightAOS = datetime(2017,1,25,0,52,35)
		fceightLOS = datetime(2017,1,25,1,5,21)
		fcnineAOS = datetime(2017,1,25,0,50,43)
		fcnineLOS = datetime(2017,1,25,1,3,31)
		fctenAOS = datetime(2017,1,25,0,53,57)
		fctenLOS = datetime(2017,1,25,1,6,40)
		fcelevenAOS = datetime(2017,1,25,0,59,45)
		fcelevenLOS = datetime(2017,1,25,1,12,25)	
		fethirteenAOS = datetime(2017,1,25,1,7,32)
		fethirteenLOS = datetime(2017,1,25,1,15,6)	
		fefourteenAOS = datetime(2017,1,25,0,0,33)
		fefourteenLOS = datetime(2017,1,25,0,8,13)	
		itupAOS = datetime(2017,1,25,0,22,12)
		itupLOS = datetime(2017,1,25,0,34,49)	

		catTLE = TLE(0,"cat","line1","line2")
		sixtysevenCTLE = TLE(1,"sixtysevenC","line1","line2")
		sixtysevenDTLE= TLE(1,"sixtysevenD","line1","line2")
		aistTLE= TLE(1,"aist","line1","line2")
		beesatTLE= TLE(1,"beesat","line1","line2")
		briteTLE= TLE(1,"brite","line1","line2")
		cubebugTLE= TLE(1,"cubebug","line1","line2")
		sailTLE= TLE(1,"sail","line1","line2")
		eagleTLE= TLE(1,"eagle","line1","line2")
		exoTLE= TLE(1,"exo","line1","line2")
		fconeTLE= TLE(1,"fcone","line1","line2")
		fcthreeTLE= TLE(1,"fcthree","line1","line2")
		fcfiveTLE= TLE(1,"fcfive","line1","line2")
		fceightTLE	= TLE(1,"fceight","line1","line2")
		fcnineTLE= TLE(1,"fcnine","line1","line2")
		fctenTLE= TLE(1,"fcten","line1","line2")
		fcelevenTLE= TLE(1,"fceleven","line1","line2")
		fethirteenTLE= TLE(1,"fethirteen","line1","line2")
		fefourteenTLE= TLE(1,"fefourteen","line1","line2")
		itupTLE= TLE(1,"itup","line1","line2")

		date1 = datetime(2017, 1, 1, 12, 0, 0)
			# id, tle, riseTime, setTime, duration, maxElevation, riseAzimuth, setAzimuth
		cat = NextPass(0,catTLE, catAOS, catLOS, 0,0,0,0)
		sixtysevenC = NextPass(1,sixtysevenCTLE,sixtysevenCAOS, sixtysevenCLOS,date1,date1,date1,date1)
		sixtysevenD = NextPass(2,sixtysevenDTLE,sixtysevenDAOS, sixtysevenDLOS,date1,date1,date1,date1)
		aist = NextPass(3,aistTLE,aistAOS, aistLOS,date1,date1,date1,date1)
		beesat = NextPass(4,beesatTLE,beesatAOS, beesatLOS,date1,date1,date1,date1)
		brite = NextPass(5,briteTLE,briteAOS, briteLOS,date1,date1,date1,date1)
		cubebug = NextPass(6,cubebugTLE,cubebugAOS, cubebugLOS,date1,date1,date1,date1)
		sail = NextPass(7,sailTLE,sailAOS, sailLOS,date1,date1,date1,date1)
		eagle = NextPass(8,eagleTLE,eagleAOS, eagleLOS,date1,date1,date1,date1)
		exo = NextPass(9,exoTLE,exoAOS,exoLOS,date1,date1,date1,date1)
		fcone = NextPass(10,fconeTLE,fconeAOS,fconeLOS,date1,date1,date1,date1)
		fcthree = NextPass(11,fcthreeTLE,fcthreeAOS, fcthreeLOS,date1,date1,date1,date1)
		fcfive = NextPass(12,fcfiveTLE,fcfiveAOS, fcfiveLOS,date1,date1,date1,date1)
		fceight = NextPass(13,fceightTLE,fceightAOS,fceightLOS,date1,date1,date1,date1)
		fcnine = NextPass(14,fcnineTLE,fcnineAOS,fcnineLOS,date1,date1,date1,date1)
		fcten = NextPass(15,fctenTLE,fctenAOS, fctenLOS,date1,date1,date1,date1)
		fceleven = NextPass(16,fcelevenTLE,fcelevenAOS, fcelevenLOS,date1,date1,date1,date1)
		fethirteen = NextPass(17,fethirteenTLE,fethirteenAOS,fethirteenLOS,date1,date1,date1,date1)
		fefourteen = NextPass(18,fefourteenTLE,fefourteenAOS,fefourteenLOS,date1,date1,date1,date1)
		itup = NextPass(19,itupTLE,itupAOS, itupLOS,date1,date1,date1,date1)		

		satList=[cat,sixtysevenC,sixtysevenD,aist,beesat,brite,cubebug,sail,eagle,
		exo,fcone,fcthree,fcfive,fcfive,fceight,fcnine,fcten,fceleven,fethirteen,fefourteen,
		itup]
		
		shouldBe = _Helper.fitnessFunction(satList)
		
		self.assertIs(shouldBe == 8,True)

def test_findSchedulableSatellites_many_fake_sats():

	sat1AOS = datetime(2017,1,25,12,2,0)
	sat1LOS = datetime(2017,1,25,12,5,0)
	sat2AOS = datetime(2017,1,25,12,0,0)
	sat2LOS = datetime(2017,1,25,12,8,0)
	sat3AOS = datetime(2017,1,25,12,25,0)
	sat3LOS = datetime(2017,1,25,12,30,0)
	sat4AOS = datetime(2017,1,25,11,57,0)
	sat4LOS = datetime(2017,1,25,12,3,0)
	sat5AOS = datetime(2017,1,25,12,7,0)
	sat5LOS = datetime(2017,1,25,12,10,0)
	sat6AOS = datetime(2017,1,25,11,57,0)
	sat6LOS = datetime(2017,1,25,12,4,0)
	sat7AOS = datetime(2017,1,25,11,57,0)
	sat7LOS = datetime(2017,1,25,12,4,0)
	sat8AOS = datetime(2017,1,25,11,57,0)
	sat8LOS = datetime(2017,1,25,12,4,0)
	sat9AOS = datetime(2017,1,25,13,0,0)
	sat9LOS = datetime(2017,1,25,13,4,0)
	sat10AOS = datetime(2017,1,25,12,27,0)
	sat10LOS = datetime(2017,1,25,12,31,0)
	sat11AOS = datetime(2017,1,25,12,28,0)
	sat11LOS = datetime(2017,1,25,12,34,0)

	sat1 = satellite("sat1",sat1AOS, sat1LOS)
	sat2 = satellite("sat2",sat2AOS, sat2LOS)
	sat3 = satellite("sat3",sat3AOS, sat3LOS)
	sat4 = satellite("sat4",sat4AOS, sat4LOS)
	sat5 = satellite("sat5",sat5AOS, sat5LOS)
	sat6 = satellite("sat6",sat6AOS, sat6LOS)
	sat7 = satellite("sat7",sat7AOS, sat7LOS)
	sat8 = satellite("sat8",sat8AOS, sat8LOS)
	sat9 = satellite("sat9",sat9AOS, sat9LOS)
	sat10 = satellite("sat10",sat10AOS,sat10LOS)
	sat11 = satellite("sat11",sat11AOS,sat11LOS)

	satList=[sat1,sat2,sat3,sat4,sat5,sat6,sat7,sat8,sat9,sat10,sat11]

	fitnessFunction(satList)

def test_findSchedulableSatellites_many_fake_sats_but_diff():

	sat1AOS = datetime(2017,1,25,12,2,0)
	sat1LOS = datetime(2017,1,25,12,5,0)
	sat2AOS = datetime(2017,1,25,12,0,0)
	sat2LOS = datetime(2017,1,25,12,8,0)
	sat3AOS = datetime(2017,1,25,12,25,0)
	sat3LOS = datetime(2017,1,25,12,30,0)
	sat4AOS = datetime(2017,1,25,11,57,0)
	sat4LOS = datetime(2017,1,25,12,3,0)
	sat5AOS = datetime(2017,1,25,12,7,0)
	sat5LOS = datetime(2017,1,25,12,10,0)
	sat6AOS = datetime(2017,1,25,11,57,0)
	sat6LOS = datetime(2017,1,25,12,4,0)
	sat7AOS = datetime(2017,1,25,11,57,0)
	sat7LOS = datetime(2017,1,25,12,4,0)
	sat8AOS = datetime(2017,1,25,12,59,0)
	sat8LOS = datetime(2017,1,25,13,3,0)
	sat9AOS = datetime(2017,1,25,13,0,0)
	sat9LOS = datetime(2017,1,25,13,4,0)
	sat10AOS = datetime(2017,1,25,12,27,0)
	sat10LOS = datetime(2017,1,25,12,31,0)
	sat11AOS = datetime(2017,1,25,12,28,0)
	sat11LOS = datetime(2017,1,25,12,34,0)

	sat1 = satellite("sat1",sat1AOS, sat1LOS)
	sat2 = satellite("sat2",sat2AOS, sat2LOS)
	sat3 = satellite("sat3",sat3AOS, sat3LOS)
	sat4 = satellite("sat4",sat4AOS, sat4LOS)
	sat5 = satellite("sat5",sat5AOS, sat5LOS)
	sat6 = satellite("sat6",sat6AOS, sat6LOS)
	sat7 = satellite("sat7",sat7AOS, sat7LOS)
	sat8 = satellite("sat8",sat8AOS, sat8LOS)
	sat9 = satellite("sat9",sat9AOS, sat9LOS)
	sat10 = satellite("sat10",sat10AOS,sat10LOS)
	sat11 = satellite("sat11",sat11AOS,sat11LOS)

	satList=[sat1,sat2,sat3,sat4,sat5,sat6,sat7,sat8,sat9,sat10,sat11]

	fitnessFunction(satList)

def test_hillclimbing_many_real_sats():
	sat1AOS = datetime(2017,1,25,12,2,0)
	sat1LOS = datetime(2017,1,25,12,5,0)
	sat2AOS = datetime(2017,1,25,12,0,0)
	sat2LOS = datetime(2017,1,25,12,8,0)
	sat3AOS = datetime(2017,1,25,12,25,0)
	sat3LOS = datetime(2017,1,25,12,30,0)
	sat4AOS = datetime(2017,1,25,11,57,0)
	sat4LOS = datetime(2017,1,25,12,3,0)
	sat5AOS = datetime(2017,1,25,12,7,0)
	sat5LOS = datetime(2017,1,25,12,10,0)
	sat6AOS = datetime(2017,1,25,11,57,0)
	sat6LOS = datetime(2017,1,25,12,4,0)
	sat7AOS = datetime(2017,1,25,11,57,0)
	sat7LOS = datetime(2017,1,25,12,4,0)
	sat8AOS = datetime(2017,1,25,11,57,0)
	sat8LOS = datetime(2017,1,25,12,4,0)
	sat9AOS = datetime(2017,1,25,13,0,0)
	sat9LOS = datetime(2017,1,25,13,4,0)
	sat10AOS = datetime(2017,1,25,12,27,0)
	sat10LOS = datetime(2017,1,25,12,31,0)
	sat11AOS = datetime(2017,1,25,12,28,0)
	sat11LOS = datetime(2017,1,25,12,34,0)

	sat1 = satellite("sat1",sat1AOS, sat1LOS)
	sat2 = satellite("sat2",sat2AOS, sat2LOS)
	sat3 = satellite("sat3",sat3AOS, sat3LOS)
	sat4 = satellite("sat4",sat4AOS, sat4LOS)
	sat5 = satellite("sat5",sat5AOS, sat5LOS)
	sat6 = satellite("sat6",sat6AOS, sat6LOS)
	sat7 = satellite("sat7",sat7AOS, sat7LOS)
	sat8 = satellite("sat8",sat8AOS, sat8LOS)
	sat9 = satellite("sat9",sat9AOS, sat9LOS)
	sat10 = satellite("sat10",sat10AOS,sat10LOS)
	sat11 = satellite("sat11",sat11AOS,sat11LOS)

	satList=[sat1,sat2,sat3,sat4,sat5,sat6,sat7,sat8,sat9,sat10,sat11]

	hillclimbing(satList)

def test_hillclimbing_many_fake_sats():

	sat1AOS = datetime(2017,1,25,12,2,0)
	sat1LOS = datetime(2017,1,25,12,5,0)
	sat2AOS = datetime(2017,1,25,12,0,0)
	sat2LOS = datetime(2017,1,25,12,8,0)
	sat3AOS = datetime(2017,1,25,12,25,0)
	sat3LOS = datetime(2017,1,25,12,30,0)
	sat4AOS = datetime(2017,1,25,11,57,0)
	sat4LOS = datetime(2017,1,25,12,3,0)
	sat5AOS = datetime(2017,1,25,12,7,0)
	sat5LOS = datetime(2017,1,25,12,10,0)
	sat6AOS = datetime(2017,1,25,11,57,0)
	sat6LOS = datetime(2017,1,25,12,4,0)
	sat7AOS = datetime(2017,1,25,11,57,0)
	sat7LOS = datetime(2017,1,25,12,4,0)
	sat8AOS = datetime(2017,1,25,11,57,0)
	sat8LOS = datetime(2017,1,25,12,4,0)
	sat9AOS = datetime(2017,1,25,11,57,0)
	sat9LOS = datetime(2017,1,25,12,4,0)
	# sat10AOS = datetime(2017,1,25,12,27,0)
	# sat10LOS = datetime(2017,1,25,12,31,0)
	# sat11AOS = datetime(2017,1,25,12,28,0)
	# sat11LOS = datetime(2017,1,25,12,34,0)

	sat1 = satellite("sat1",sat1AOS, sat1LOS)
	sat2 = satellite("sat2",sat2AOS, sat2LOS)
	sat3 = satellite("sat3",sat3AOS, sat3LOS)
	sat4 = satellite("sat4",sat4AOS, sat4LOS)
	sat5 = satellite("sat5",sat5AOS, sat5LOS)
	sat6 = satellite("sat6",sat6AOS, sat6LOS)
	sat7 = satellite("sat7",sat7AOS, sat7LOS)
	sat8 = satellite("sat8",sat8AOS, sat8LOS)
	sat9 = satellite("sat9",sat9AOS, sat9LOS)
	# sat10 = satellite("sat10",sat10AOS,sat10LOS)
	# sat11 = satellite("sat11",sat11AOS,sat11LOS)

	satList=[sat1,sat2,sat3,sat4,sat5,sat6,sat7,sat8,sat9]#,sat10,sat11]

	hillclimbing(satList)

def test_hillclimbing_many_fake_sats_but_diff():

	sat1AOS = datetime(2017,1,25,12,2,0)
	sat1LOS = datetime(2017,1,25,12,5,0)
	sat2AOS = datetime(2017,1,25,12,0,0)
	sat2LOS = datetime(2017,1,25,12,8,0)
	sat3AOS = datetime(2017,1,25,12,25,0)
	sat3LOS = datetime(2017,1,25,12,30,0)
	sat4AOS = datetime(2017,1,25,11,57,0)
	sat4LOS = datetime(2017,1,25,12,3,0)
	sat5AOS = datetime(2017,1,25,12,7,0)
	sat5LOS = datetime(2017,1,25,12,10,0)
	sat6AOS = datetime(2017,1,25,11,57,0)
	sat6LOS = datetime(2017,1,25,12,4,0)
	sat7AOS = datetime(2017,1,25,11,57,0)
	sat7LOS = datetime(2017,1,25,12,4,0)
	sat8AOS = datetime(2017,1,25,12,59,0)
	sat8LOS = datetime(2017,1,25,13,3,0)
	sat9AOS = datetime(2017,1,25,13,0,0)
	sat9LOS = datetime(2017,1,25,13,4,0)
	sat10AOS = datetime(2017,1,25,12,27,0)
	sat10LOS = datetime(2017,1,25,12,31,0)
	sat11AOS = datetime(2017,1,25,12,28,0)
	sat11LOS = datetime(2017,1,25,12,34,0)

	sat1 = satellite("sat1",sat1AOS, sat1LOS)
	sat2 = satellite("sat2",sat2AOS, sat2LOS)
	sat3 = satellite("sat3",sat3AOS, sat3LOS)
	sat4 = satellite("sat4",sat4AOS, sat4LOS)
	sat5 = satellite("sat5",sat5AOS, sat5LOS)
	sat6 = satellite("sat6",sat6AOS, sat6LOS)
	sat7 = satellite("sat7",sat7AOS, sat7LOS)
	sat8 = satellite("sat8",sat8AOS, sat8LOS)
	sat9 = satellite("sat9",sat9AOS, sat9LOS)
	sat10 = satellite("sat10",sat10AOS,sat10LOS)
	sat11 = satellite("sat11",sat11AOS,sat11LOS)

	satList=[sat1,sat2,sat3,sat4,sat5,sat6,sat7,sat8,sat9,sat10,sat11]

	hillclimbing(satList)


def test_hillclimb_many_real_sats():
	catAOS = datetime(2017,1,25,0,52,59)
	catLOS = datetime(2017,1,25,1,4,28)
	sixtysevenCAOS = datetime(2017,1,25,0,6,52)
	sixtysevenCLOS = datetime(2017,1,25,0,14,42)
	sixtysevenDAOS = datetime(2017,1,25,0,8,37)
	sixtysevenDLOS = datetime(2017,1,25,0,16,18)
	aistAOS = datetime(2017,1,25,0,35,21)
	aistLOS = datetime(2017,1,25,0,48,8)
	beesatAOS = datetime(2017,1,25,0,46,48)
	beesatLOS = datetime(2017,1,25,1,0,4) 
	briteAOS = datetime(2017,1,25,0,19,39)
	briteLOS = datetime(2017,1,25,0,30,4)
	cubebugAOS = datetime(2017,1,25,0,41,54)
	cubebugLOS = datetime(2017,1,25,0,52,49)
	sailAOS = datetime(2017,1,25,0,41,17)
	sailLOS = datetime(2017,1,25,0,53,28)
	eagleAOS = datetime(2017,1,25,0,53,13)
	eagleLOS = datetime(2017,1,25,1,2,56)	
	exoAOS = datetime(2017,1,25,0,57,27)
	exoLOS = datetime(2017,1,25,1,5,27)
	fconeAOS = datetime(2017,1,25,0,17,14)
	fconeLOS = datetime(2017,1,25,0,30,6)
	fcthreeAOS = datetime(2017,1,25,0,11,3)
	fcthreeLOS = datetime(2017,1,25,0,23,54)
	fcfiveAOS = datetime(2017,1,25,0,8,47)
	fcfiveLOS = datetime(2017,1,25,0,21,37)
	fceightAOS = datetime(2017,1,25,0,52,35)
	fceightLOS = datetime(2017,1,25,1,5,21)
	fcnineAOS = datetime(2017,1,25,0,50,43)
	fcnineLOS = datetime(2017,1,25,1,3,31)
	fctenAOS = datetime(2017,1,25,0,53,57)
	fctenLOS = datetime(2017,1,25,1,6,40)
	fcelevenAOS = datetime(2017,1,25,0,59,45)
	fcelevenLOS = datetime(2017,1,25,1,12,25)	
	fethirteenAOS = datetime(2017,1,25,1,7,32)
	fethirteenLOS = datetime(2017,1,25,1,15,6)	
	fefourteenAOS = datetime(2017,1,25,0,0,33)
	fefourteenLOS = datetime(2017,1,25,0,8,13)	
	itupAOS = datetime(2017,1,25,0,22,12)
	itupLOS = datetime(2017,1,25,0,34,49)	

	#09 

	cat = satellite("cat",catAOS, catLOS)
	sixtysevenC = satellite("sixtysevenC",sixtysevenCAOS, sixtysevenCLOS)
	sixtysevenD = satellite("sixtysevenD",sixtysevenDAOS, sixtysevenDLOS)
	aist = satellite("aist",aistAOS, aistLOS)
	beesat = satellite("beesat",beesatAOS, beesatLOS)
	brite = satellite("brite",briteAOS, briteLOS)
	cubebug = satellite("cubebug",cubebugAOS, cubebugLOS)
	sail = satellite("sail",sailAOS, sailLOS)
	eagle = satellite("eagle",eagleAOS, eagleLOS)
	exo = satellite("exo",exoAOS,exoLOS)
	fcone = satellite("fcone",fconeAOS,fconeLOS)
	fcthree = satellite("fcthree",fcthreeAOS, fcthreeLOS)
	fcfive = satellite("fcfive",fcfiveAOS, fcfiveLOS)
	fceight = satellite("fceight",fceightAOS,fceightLOS)
	fcnine = satellite("fcnine",fcnineAOS,fcnineLOS)
	fcten = satellite("fcten",fctenAOS, fctenLOS)
	fceleven = satellite("fceleven",fcelevenAOS, fcelevenLOS)
	fethirteen = satellite("fethirteen",fethirteenAOS,fethirteenLOS)
	fefourteen = satellite("fefourteen",fefourteenAOS,fefourteenLOS)
	itup = satellite("itup",itupAOS, itupLOS)

	#satList=[sat1,sat2,sat3,sat5]
	satList=[cat,sixtysevenC,sixtysevenD,aist,beesat,brite,cubebug,sail,eagle,
	exo,fcone,fcthree,fcfive,fcfive,fceight,fcnine,fcten,fceleven,fethirteen,fefourteen,
	itup]
	# satList=["cat","sixtysevenC","sixtysevenD","aist","beesat","brite","cubebug","sail","eagle",
	# "exo","fcone","fcthree","fcfive","fcfive","fceight","fcnine","fcten","fceleven","fethirteen","fefourteen",
	# "itup"]
	
	randomRestart(satList)
